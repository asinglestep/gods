# avl树

## 一、性质
任意节点2个子树的高度最大差为1

## 二、插入
### 2.1 插入：同二叉树

### 2.2 插入修复：（n：修复节点，lh：左子树高度，rh：右子树高度）
#### 2.2.1 lh - rh = 2，且插入节点在n的左节点的左侧  
操作：将n右旋。  
说明：插入新节点后，n的左子树比右子树高2，此时需要重新修复。假设n的高度为x，左子树的高度为x-1，左子树的左子树的高度为x-2，
则左子树的右子树的高度为x-2或者x-3（如果左子树的右子树的高度为x-1，则左子树的高度应该为x），右子树的高度为x-2（如果右子树的高度为x-1，插入新节点后，不需要修复），
此时再n的左子树的左子树上插入一个新节点，左子树的高度为x，左子树的左子树的高度为x-1，比右子树高2，将n右旋后，n的左子树的右子树变成其左子树，所以右旋后，
n依然是一个avl树（其左子树的高度为x-2或者x-3，右子树的高度为x-2），此时n的左节点变成新的父节点（p），n变成p的右子树，n的高度为x-1，
对新的父节点（p）来说，也是一个avl树（其左子树高度为x-1，右子树的高度为x-1），高度为x。

#### 2.2.2 lh - rh = 2，且插入节点在其左节点的右侧
操作：先将其左节点左旋，再将其右旋。

#### 2.2.3 lh - rh = -2，且插入节点在其右节点的右侧
操作：将其左旋。

#### 2.2.4. lh - rh = -2，且插入节点在其右节点的左侧
操作：先将其右节点右旋，再将其左旋。

## 三、删除
### 3.1 删除：同二叉树

### 3.2 删除修复：（n：修复节点，lh：左子树高度，rh：右子树高度）
#### 3.2.1 lh - rh = 2
##### 3.2.1.1 n的左节点的右子树比左子树高
操作：先将n的左节点左旋，再将n右旋。  
说明：假设n的高度为x，n的左节点的高度为x-1，因为lh - rh = 2，所以n的右节点的高度为x-3，因为n的左节点的右子树比左子树高，所以n的左节点的右子树的高度为x-2，
n的左节点的左子树的高度为x-3，对于n的左节点的右节点（nlr）来说，有2种情况，(1). nlr的左节点为x-3，右节点为x-3或者x-4，(2). nlr的右节点为x-3，左节点为x-3或者x-4，
对于这2种情况，将n的左节点左旋后，旧的n的左节点依然是一个avl树，高度为x-2，旧的n的左节点的右节点成为新的n的左节点。将n右旋，对于旧的n来说，也是一个avl树，高度为x-2，
旧的n的左节点的右节点成为新的n，新的n也是一个avl树，高度为x-1，继续对新的n进行修复。

##### 3.2.1.2 n的左节点的左子树比右子树高或者左节点的左子树的高度和右子树相等
操作：将n右旋。  
说明：假设n的高度为x，n的左节点的高度为x-1，因为lh - rh = 2，所以n的右节点的高度为x-3，因为n的左节点的左子树比右子树高或者左节点的左子树的高度和右子树相等，
所以n的左节点的左子树的高度为x-2，n的左节点的右子树的高度为x-2或者x-3，将n右旋，n是一个avl树，高度为x-1或者x-2，n的左节点成为新的n，对于新的n也是一个avl树，
高度为x或者x-1，继续对新的n进行修复。

#### 3.2.2 rh - lh = 2
##### 3.2.2.1. n的右节点的左子树比右子树高
操作：先将n的右节点右旋，再将n左旋。

##### 3.2.2.2. n的右节点的右子树比左子树高或者右节点的右子树的高度等于左子树
操作：将n左旋。
